rm: cannot remove './output/result.csv': No such file or directory
==> ./train_gpt2cu 2 gpu__time_duration.sum gpu__time_duration.max gpc__cycles_elapsed.avg.per_second gpc__cycles_elapsed.max sm__cycles_active.max
Adding metric: gpu__time_duration.sum
Adding metric: gpu__time_duration.max
Adding metric: gpc__cycles_elapsed.avg.per_second
Adding metric: gpc__cycles_elapsed.max
Adding metric: sm__cycles_active.max
Setting output path: ./output/result.csv
input dataset prefix: data/tiny_shakespeare
output log file: NULL
batch size B: 4
sequence length T: 1024
learning rate: 0.000100
val_loss_every: 20
val_max_batches: 20
sample_every: 20
genT: 64
[System]
Device 0: NVIDIA A100-SXM4-40GB
enable_tf32: 1
[GPT-2]
max_seq_len: 1024
vocab_size: 50257
num_layers: 12
num_heads: 12
channels: 768
num_parameters: 124439808
allocated 474 MiB for model parameters
train dataset num_batches: 74
val dataset num_batches: 8
Initializing CUDA driver...
Compute Capability of Device: 8.0
Num of Passes: 1
Forward pass 0
num_activations: 1868386304
allocated 7127 MiB for activations
allocated 474 MiB for parameter gradients
allocated 1421 MiB for activation gradients
allocated 474 MiB for AdamW optimizer state m
allocated 474 MiB for AdamW optimizer state v
step 1/2: train loss 9.130970 (144.740961 ms)
Forward pass 1
step 2/2: train loss 8.668046 (571.483404 ms)
total average iteration time: 358.112182 ms
Number of ranges: 17
m_profilerRanges size: 17
Range Name: encoder_forward
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tEiZ15encoder_forwardPfRKN6thrust20THRUST_200700_800_NS13device_vectorIiNS8_16device_allocatorIiEEEES6_S6_iiiiEUliE_EEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__cycles_active.max                                                  29668.000
gpc__cycles_elapsed.max                                                31964.000
gpc__cycles_elapsed.avg.per_second                                1395114295.718
gpu__time_duration.max                                                 22848.000
gpu__time_duration.sum                                                 22848.000
-----------------------------------------------------------------------------------
Range Name: ln1
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__cycles_active.max                                                  26845.000
gpc__cycles_elapsed.max                                                29148.000
gpc__cycles_elapsed.avg.per_second                                1389375819.135
gpu__time_duration.max                                                 20928.000
gpu__time_duration.sum                                                 20928.000
-----------------------------------------------------------------------------------
Range Name: attention
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__cycles_active.max                                                 188602.000
gpc__cycles_elapsed.max                                               191926.000
gpc__cycles_elapsed.avg.per_second                                1400488552.363
gpu__time_duration.max                                                136672.000
gpu__time_duration.sum                                                136672.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElNS2_12op_wrapper_tIlZ17attention_forwardPfS7_S7_S7_S7_S7_iiiiEUliE_N6thrust20THRUST_200700_800_NS17counting_iteratorIiNSA_11use_defaultESC_SC_EEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__cycles_active.max                                                  81241.000
gpc__cycles_elapsed.max                                                83638.000
gpc__cycles_elapsed.avg.per_second                                1404836429.725
gpu__time_duration.max                                                 59424.000
gpu__time_duration.sum                                                 59424.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I51cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4EEvNT_6ParamsE<<<{64, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__cycles_active.max                                                 252714.000
gpc__cycles_elapsed.max                                               255527.000
gpc__cycles_elapsed.avg.per_second                                1402547047.066
gpu__time_duration.max                                                181824.000
gpu__time_duration.sum                                                181824.000
-----------------------------------------------------------------------------------
Kernel: _Z23softmax_forward_kernel5PffPKfii<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__cycles_active.max                                                 222406.000
gpc__cycles_elapsed.max                                               225758.000
gpc__cycles_elapsed.avg.per_second                                1421215626.081
gpu__time_duration.max                                                158592.000
gpu__time_duration.sum                                                158592.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I50cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4EEvNT_6ParamsE<<<{16, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__cycles_active.max                                                 259401.000
gpc__cycles_elapsed.max                                               261769.000
gpc__cycles_elapsed.avg.per_second                                1404723755.039
gpu__time_duration.max                                                185984.000
gpu__time_duration.sum                                                185984.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEENS7_20permutation_iteratorIPfNS7_18transform_iteratorIZ17attention_forwardSF_SF_SF_SF_SF_SF_iiiiEUliE0_NS7_17counting_iteratorIiNS7_11use_defaultESJ_SJ_EESJ_SJ_EEEENS9_14no_stencil_tagENS8_8identityENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__cycles_active.max                                                  25540.000
gpc__cycles_elapsed.max                                                27827.000
gpc__cycles_elapsed.avg.per_second                                1393460036.748
gpu__time_duration.max                                                 19904.000
gpu__time_duration.sum                                                 19904.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 1, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__cycles_active.max                                                  64808.000
gpc__cycles_elapsed.max                                                67380.000
gpc__cycles_elapsed.avg.per_second                                1396692154.255
gpu__time_duration.max                                                 48128.000
gpu__time_duration.sum                                                 48128.000
-----------------------------------------------------------------------------------
Range Name: residual1
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__cycles_active.max                                                  29404.000
gpc__cycles_elapsed.max                                                32012.000
gpc__cycles_elapsed.avg.per_second                                1396708683.473
gpu__time_duration.max                                                 22848.000
gpu__time_duration.sum                                                 22848.000
-----------------------------------------------------------------------------------
Range Name: ln2
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__cycles_active.max                                                  28768.000
gpc__cycles_elapsed.max                                                31041.000
gpc__cycles_elapsed.avg.per_second                                1393133350.462
gpu__time_duration.max                                                 22240.000
gpu__time_duration.sum                                                 22240.000
-----------------------------------------------------------------------------------
Range Name: ff
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__cycles_active.max                                                 246793.000
gpc__cycles_elapsed.max                                               250054.000
gpc__cycles_elapsed.avg.per_second                                1400799894.675
gpu__time_duration.max                                                177952.000
gpu__time_duration.sum                                                177952.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fIPKfPfNS9_14no_stencil_tagEZ12gelu_forwardSD_SC_iEUlfE_NS9_21always_true_predicateEEEEEvT0_T1_<<<{24576, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__cycles_active.max                                                 106909.000
gpc__cycles_elapsed.max                                               109581.000
gpc__cycles_elapsed.avg.per_second                                1404941185.973
gpu__time_duration.max                                                 77824.000
gpu__time_duration.sum                                                 77824.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x256_32x3_tn_align4EEvNT_6ParamsE<<<{128, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__cycles_active.max                                                 218096.000
gpc__cycles_elapsed.max                                               220714.000
gpc__cycles_elapsed.avg.per_second                                1400772465.789
gpu__time_duration.max                                                157344.000
gpu__time_duration.sum                                                157344.000
-----------------------------------------------------------------------------------
Range Name: residual2
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__cycles_active.max                                                  23267.000
gpc__cycles_elapsed.max                                                25688.000
gpc__cycles_elapsed.avg.per_second                                1398326477.188
gpu__time_duration.max                                                 18336.000
gpu__time_duration.sum                                                 18336.000
-----------------------------------------------------------------------------------
Range Name: vecadd
======================================================================================
Kernel: _Z6vecAddPKfS0_Pfi<<<{12288, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__cycles_active.max                                                  31613.000
gpc__cycles_elapsed.max                                                34129.000
gpc__cycles_elapsed.avg.per_second                                1399900140.977
gpu__time_duration.max                                                 24320.000
gpu__time_duration.sum                                                 24320.000
-----------------------------------------------------------------------------------
Range Name: vecadd_thrust
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__cycles_active.max                                                  22315.000
gpc__cycles_elapsed.max                                                24787.000
gpc__cycles_elapsed.avg.per_second                                1396741232.594
gpu__time_duration.max                                                 17728.000
gpu__time_duration.sum                                                 17728.000
-----------------------------------------------------------------------------------
==> ./train_gpt2cu 2 dram__throughput.avg.pct_of_peak_sustained_elapsed --mean
Adding metric: dram__throughput.avg.pct_of_peak_sustained_elapsed
Setting output option to MEAN
Setting output path: ./output/result.csv
input dataset prefix: data/tiny_shakespeare
output log file: NULL
batch size B: 4
sequence length T: 1024
learning rate: 0.000100
val_loss_every: 20
val_max_batches: 20
sample_every: 20
genT: 64
[System]
Device 0: NVIDIA A100-SXM4-40GB
enable_tf32: 1
[GPT-2]
max_seq_len: 1024
vocab_size: 50257
num_layers: 12
num_heads: 12
channels: 768
num_parameters: 124439808
allocated 474 MiB for model parameters
train dataset num_batches: 74
val dataset num_batches: 8
Initializing CUDA driver...
Compute Capability of Device: 8.0
Num of Passes: 1
Forward pass 0
num_activations: 1868386304
allocated 7127 MiB for activations
allocated 474 MiB for parameter gradients
allocated 1421 MiB for activation gradients
allocated 474 MiB for AdamW optimizer state m
allocated 474 MiB for AdamW optimizer state v
step 1/2: train loss 9.130970 (144.880408 ms)
Forward pass 1
step 2/2: train loss 8.668051 (256.432743 ms)
total average iteration time: 200.656576 ms
Number of ranges: 17
m_profilerRanges size: 17
Range Name: encoder_forward
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tEiZ15encoder_forwardPfRKN6thrust20THRUST_200700_800_NS13device_vectorIiNS8_16device_allocatorIiEEEES6_S6_iiiiEUliE_EEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__throughput.avg.pct_of_peak_sustained_elapsed                        55.468
-----------------------------------------------------------------------------------
Range Name: ln1
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__throughput.avg.pct_of_peak_sustained_elapsed                        29.439
-----------------------------------------------------------------------------------
Range Name: attention
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__throughput.avg.pct_of_peak_sustained_elapsed                        36.340
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElNS2_12op_wrapper_tIlZ17attention_forwardPfS7_S7_S7_S7_S7_iiiiEUliE_N6thrust20THRUST_200700_800_NS17counting_iteratorIiNSA_11use_defaultESC_SC_EEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__throughput.avg.pct_of_peak_sustained_elapsed                        71.409
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I51cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4EEvNT_6ParamsE<<<{64, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__throughput.avg.pct_of_peak_sustained_elapsed                        77.867
-----------------------------------------------------------------------------------
Kernel: _Z23softmax_forward_kernel5PffPKfii<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__throughput.avg.pct_of_peak_sustained_elapsed                        79.319
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I50cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4EEvNT_6ParamsE<<<{16, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__throughput.avg.pct_of_peak_sustained_elapsed                        80.516
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEENS7_20permutation_iteratorIPfNS7_18transform_iteratorIZ17attention_forwardSF_SF_SF_SF_SF_SF_iiiiEUliE0_NS7_17counting_iteratorIiNS7_11use_defaultESJ_SJ_EESJ_SJ_EEEENS9_14no_stencil_tagENS8_8identityENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__throughput.avg.pct_of_peak_sustained_elapsed                        35.549
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 1, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__throughput.avg.pct_of_peak_sustained_elapsed                        13.149
-----------------------------------------------------------------------------------
Range Name: residual1
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__throughput.avg.pct_of_peak_sustained_elapsed                        73.046
-----------------------------------------------------------------------------------
Range Name: ln2
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__throughput.avg.pct_of_peak_sustained_elapsed                        33.757
-----------------------------------------------------------------------------------
Range Name: ff
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__throughput.avg.pct_of_peak_sustained_elapsed                        35.716
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fIPKfPfNS9_14no_stencil_tagEZ12gelu_forwardSD_SC_iEUlfE_NS9_21always_true_predicateEEEEEvT0_T1_<<<{24576, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__throughput.avg.pct_of_peak_sustained_elapsed                        82.666
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x256_32x3_tn_align4EEvNT_6ParamsE<<<{128, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__throughput.avg.pct_of_peak_sustained_elapsed                        29.093
-----------------------------------------------------------------------------------
Range Name: residual2
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__throughput.avg.pct_of_peak_sustained_elapsed                        63.541
-----------------------------------------------------------------------------------
Range Name: vecadd
======================================================================================
Kernel: _Z6vecAddPKfS0_Pfi<<<{12288, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__throughput.avg.pct_of_peak_sustained_elapsed                        74.858
-----------------------------------------------------------------------------------
Range Name: vecadd_thrust
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__throughput.avg.pct_of_peak_sustained_elapsed                        56.432
-----------------------------------------------------------------------------------
==> ./train_gpt2cu 2 smsp__inst_executed.sum
Adding metric: smsp__inst_executed.sum
Setting output path: ./output/result.csv
input dataset prefix: data/tiny_shakespeare
output log file: NULL
batch size B: 4
sequence length T: 1024
learning rate: 0.000100
val_loss_every: 20
val_max_batches: 20
sample_every: 20
genT: 64
[System]
Device 0: NVIDIA A100-SXM4-40GB
enable_tf32: 1
[GPT-2]
max_seq_len: 1024
vocab_size: 50257
num_layers: 12
num_heads: 12
channels: 768
num_parameters: 124439808
allocated 474 MiB for model parameters
train dataset num_batches: 74
val dataset num_batches: 8
Initializing CUDA driver...
Compute Capability of Device: 8.0
Num of Passes: 1
Forward pass 0
num_activations: 1868386304
allocated 7127 MiB for activations
allocated 474 MiB for parameter gradients
allocated 1421 MiB for activation gradients
allocated 474 MiB for AdamW optimizer state m
allocated 474 MiB for AdamW optimizer state v
step 1/2: train loss 9.130970 (144.637336 ms)
Forward pass 1
step 2/2: train loss 8.668056 (480.901669 ms)
total average iteration time: 312.769503 ms
Number of ranges: 17
m_profilerRanges size: 17
Range Name: encoder_forward
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tEiZ15encoder_forwardPfRKN6thrust20THRUST_200700_800_NS13device_vectorIiNS8_16device_allocatorIiEEEES6_S6_iiiiEUliE_EEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__inst_executed.sum                                              6144000.000
-----------------------------------------------------------------------------------
Range Name: ln1
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__inst_executed.sum                                              4067328.000
-----------------------------------------------------------------------------------
Range Name: attention
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__inst_executed.sum                                             32131584.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElNS2_12op_wrapper_tIlZ17attention_forwardPfS7_S7_S7_S7_S7_iiiiEUliE_N6thrust20THRUST_200700_800_NS17counting_iteratorIiNSA_11use_defaultESC_SC_EEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__inst_executed.sum                                              8503296.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I51cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4EEvNT_6ParamsE<<<{64, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__inst_executed.sum                                             27353088.000
-----------------------------------------------------------------------------------
Kernel: _Z23softmax_forward_kernel5PffPKfii<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__inst_executed.sum                                             30907632.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I50cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4EEvNT_6ParamsE<<<{16, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__inst_executed.sum                                             30440448.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEENS7_20permutation_iteratorIPfNS7_18transform_iteratorIZ17attention_forwardSF_SF_SF_SF_SF_SF_iiiiEUliE0_NS7_17counting_iteratorIiNS7_11use_defaultESJ_SJ_EESJ_SJ_EEEENS9_14no_stencil_tagENS8_8identityENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__inst_executed.sum                                              8208384.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 1, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__inst_executed.sum                                             10710528.000
-----------------------------------------------------------------------------------
Range Name: residual1
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__inst_executed.sum                                              1867776.000
-----------------------------------------------------------------------------------
Range Name: ln2
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__inst_executed.sum                                              4067328.000
-----------------------------------------------------------------------------------
Range Name: ff
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__inst_executed.sum                                             42829824.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fIPKfPfNS9_14no_stencil_tagEZ12gelu_forwardSD_SC_iEUlfE_NS9_21always_true_predicateEEEEEvT0_T1_<<<{24576, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__inst_executed.sum                                              7667712.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x256_32x3_tn_align4EEvNT_6ParamsE<<<{128, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__inst_executed.sum                                             36899328.000
-----------------------------------------------------------------------------------
Range Name: residual2
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__inst_executed.sum                                              1867776.000
-----------------------------------------------------------------------------------
Range Name: vecadd
======================================================================================
Kernel: _Z6vecAddPKfS0_Pfi<<<{12288, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__inst_executed.sum                                              1572864.000
-----------------------------------------------------------------------------------
Range Name: vecadd_thrust
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__inst_executed.sum                                              1867776.000
-----------------------------------------------------------------------------------
==> ./train_gpt2cu 2 smsp__sass_inst_executed_op_shared_ld.sum smsp__sass_inst_executed_op_shared_st.sum smsp__sass_inst_executed_op_global_ld.sum smsp__sass_inst_executed_op_global_st.sum smsp__sass_inst_executed_op_ldgsts.sum smsp__sass_data_bytes_mem_global_op_ld.sum smsp__sass_data_bytes_mem_global_op_st.sum
Adding metric: smsp__sass_inst_executed_op_shared_ld.sum
Adding metric: smsp__sass_inst_executed_op_shared_st.sum
Adding metric: smsp__sass_inst_executed_op_global_ld.sum
Adding metric: smsp__sass_inst_executed_op_global_st.sum
Adding metric: smsp__sass_inst_executed_op_ldgsts.sum
Adding metric: smsp__sass_data_bytes_mem_global_op_ld.sum
Adding metric: smsp__sass_data_bytes_mem_global_op_st.sum
Setting output path: ./output/result.csv
input dataset prefix: data/tiny_shakespeare
output log file: NULL
batch size B: 4
sequence length T: 1024
learning rate: 0.000100
val_loss_every: 20
val_max_batches: 20
sample_every: 20
genT: 64
[System]
Device 0: NVIDIA A100-SXM4-40GB
enable_tf32: 1
[GPT-2]
max_seq_len: 1024
vocab_size: 50257
num_layers: 12
num_heads: 12
channels: 768
num_parameters: 124439808
allocated 474 MiB for model parameters
train dataset num_batches: 74
val dataset num_batches: 8
Initializing CUDA driver...
Compute Capability of Device: 8.0
Num of Passes: 1
Forward pass 0
num_activations: 1868386304
allocated 7127 MiB for activations
allocated 474 MiB for parameter gradients
allocated 1421 MiB for activation gradients
allocated 474 MiB for AdamW optimizer state m
allocated 474 MiB for AdamW optimizer state v
step 1/2: train loss 9.130970 (145.493363 ms)
Forward pass 1
step 2/2: train loss 8.668054 (1306.534580 ms)
total average iteration time: 726.013971 ms
Number of ranges: 17
m_profilerRanges size: 17
Range Name: encoder_forward
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tEiZ15encoder_forwardPfRKN6thrust20THRUST_200700_800_NS13device_vectorIiNS8_16device_allocatorIiEEEES6_S6_iiiiEUliE_EEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__sass_data_bytes_mem_global_op_st.sum                          12582912.000
smsp__sass_data_bytes_mem_global_op_ld.sum                          25559040.000
smsp__sass_inst_executed_op_ldgsts.sum                                     0.000
smsp__sass_inst_executed_op_global_st.sum                              98304.000
smsp__sass_inst_executed_op_global_ld.sum                             294912.000
smsp__sass_inst_executed_op_shared_st.sum                                  0.000
smsp__sass_inst_executed_op_shared_ld.sum                                  0.000
-----------------------------------------------------------------------------------
Range Name: ln1
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__sass_data_bytes_mem_global_op_st.sum                          12615680.000
smsp__sass_data_bytes_mem_global_op_ld.sum                          62914560.000
smsp__sass_inst_executed_op_ldgsts.sum                                     0.000
smsp__sass_inst_executed_op_global_st.sum                             106496.000
smsp__sass_inst_executed_op_global_ld.sum                             491520.000
smsp__sass_inst_executed_op_shared_st.sum                                  0.000
smsp__sass_inst_executed_op_shared_ld.sum                                  0.000
-----------------------------------------------------------------------------------
Range Name: attention
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__sass_data_bytes_mem_global_op_st.sum                          37748736.000
smsp__sass_data_bytes_mem_global_op_ld.sum                          18874368.000
smsp__sass_inst_executed_op_ldgsts.sum                                884736.000
smsp__sass_inst_executed_op_global_st.sum                              73728.000
smsp__sass_inst_executed_op_global_ld.sum                              73728.000
smsp__sass_inst_executed_op_shared_st.sum                             147456.000
smsp__sass_inst_executed_op_shared_ld.sum                              73728.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElNS2_12op_wrapper_tIlZ17attention_forwardPfS7_S7_S7_S7_S7_iiiiEUliE_N6thrust20THRUST_200700_800_NS17counting_iteratorIiNSA_11use_defaultESC_SC_EEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__sass_data_bytes_mem_global_op_st.sum                          37748736.000
smsp__sass_data_bytes_mem_global_op_ld.sum                          37748736.000
smsp__sass_inst_executed_op_ldgsts.sum                                     0.000
smsp__sass_inst_executed_op_global_st.sum                             294912.000
smsp__sass_inst_executed_op_global_ld.sum                             294912.000
smsp__sass_inst_executed_op_shared_st.sum                                  0.000
smsp__sass_inst_executed_op_shared_ld.sum                                  0.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I51cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4EEvNT_6ParamsE<<<{64, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__sass_data_bytes_mem_global_op_st.sum                         201326592.000
smsp__sass_data_bytes_mem_global_op_ld.sum                                 0.000
smsp__sass_inst_executed_op_ldgsts.sum                                491520.000
smsp__sass_inst_executed_op_global_st.sum                             393216.000
smsp__sass_inst_executed_op_global_ld.sum                                  0.000
smsp__sass_inst_executed_op_shared_st.sum                             786432.000
smsp__sass_inst_executed_op_shared_ld.sum                             393216.000
-----------------------------------------------------------------------------------
Kernel: _Z23softmax_forward_kernel5PffPKfii<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__sass_data_bytes_mem_global_op_st.sum                         100761600.000
smsp__sass_data_bytes_mem_global_op_ld.sum                         201523200.000
smsp__sass_inst_executed_op_ldgsts.sum                                     0.000
smsp__sass_inst_executed_op_global_st.sum                             811008.000
smsp__sass_inst_executed_op_global_ld.sum                            1115520.000
smsp__sass_inst_executed_op_shared_st.sum                                  0.000
smsp__sass_inst_executed_op_shared_ld.sum                                  0.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I50cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4EEvNT_6ParamsE<<<{16, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__sass_data_bytes_mem_global_op_st.sum                          12582912.000
smsp__sass_data_bytes_mem_global_op_ld.sum                                 0.000
smsp__sass_inst_executed_op_ldgsts.sum                                786432.000
smsp__sass_inst_executed_op_global_st.sum                              24576.000
smsp__sass_inst_executed_op_global_ld.sum                                  0.000
smsp__sass_inst_executed_op_shared_st.sum                              49152.000
smsp__sass_inst_executed_op_shared_ld.sum                            3194880.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEENS7_20permutation_iteratorIPfNS7_18transform_iteratorIZ17attention_forwardSF_SF_SF_SF_SF_SF_iiiiEUliE0_NS7_17counting_iteratorIiNS7_11use_defaultESJ_SJ_EESJ_SJ_EEEENS9_14no_stencil_tagENS8_8identityENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__sass_data_bytes_mem_global_op_st.sum                          12582912.000
smsp__sass_data_bytes_mem_global_op_ld.sum                          12582912.000
smsp__sass_inst_executed_op_ldgsts.sum                                     0.000
smsp__sass_inst_executed_op_global_st.sum                              98304.000
smsp__sass_inst_executed_op_global_ld.sum                              98304.000
smsp__sass_inst_executed_op_shared_st.sum                                  0.000
smsp__sass_inst_executed_op_shared_ld.sum                                  0.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 1, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__sass_data_bytes_mem_global_op_st.sum                          12582912.000
smsp__sass_data_bytes_mem_global_op_ld.sum                           6291456.000
smsp__sass_inst_executed_op_ldgsts.sum                                294912.000
smsp__sass_inst_executed_op_global_st.sum                              24576.000
smsp__sass_inst_executed_op_global_ld.sum                              24576.000
smsp__sass_inst_executed_op_shared_st.sum                              49152.000
smsp__sass_inst_executed_op_shared_ld.sum                              24576.000
-----------------------------------------------------------------------------------
Range Name: residual1
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__sass_data_bytes_mem_global_op_st.sum                          12582912.000
smsp__sass_data_bytes_mem_global_op_ld.sum                          25165824.000
smsp__sass_inst_executed_op_ldgsts.sum                                     0.000
smsp__sass_inst_executed_op_global_st.sum                              98304.000
smsp__sass_inst_executed_op_global_ld.sum                             196608.000
smsp__sass_inst_executed_op_shared_st.sum                                  0.000
smsp__sass_inst_executed_op_shared_ld.sum                                  0.000
-----------------------------------------------------------------------------------
Range Name: ln2
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__sass_data_bytes_mem_global_op_st.sum                          12615680.000
smsp__sass_data_bytes_mem_global_op_ld.sum                          62914560.000
smsp__sass_inst_executed_op_ldgsts.sum                                     0.000
smsp__sass_inst_executed_op_global_st.sum                             106496.000
smsp__sass_inst_executed_op_global_ld.sum                             491520.000
smsp__sass_inst_executed_op_shared_st.sum                                  0.000
smsp__sass_inst_executed_op_shared_ld.sum                                  0.000
-----------------------------------------------------------------------------------
Range Name: ff
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__sass_data_bytes_mem_global_op_st.sum                          50331648.000
smsp__sass_data_bytes_mem_global_op_ld.sum                          25165824.000
smsp__sass_inst_executed_op_ldgsts.sum                               1179648.000
smsp__sass_inst_executed_op_global_st.sum                              98304.000
smsp__sass_inst_executed_op_global_ld.sum                              98304.000
smsp__sass_inst_executed_op_shared_st.sum                             196608.000
smsp__sass_inst_executed_op_shared_ld.sum                              98304.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fIPKfPfNS9_14no_stencil_tagEZ12gelu_forwardSD_SC_iEUlfE_NS9_21always_true_predicateEEEEEvT0_T1_<<<{24576, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__sass_data_bytes_mem_global_op_st.sum                          50331648.000
smsp__sass_data_bytes_mem_global_op_ld.sum                          50331648.000
smsp__sass_inst_executed_op_ldgsts.sum                                     0.000
smsp__sass_inst_executed_op_global_st.sum                             393216.000
smsp__sass_inst_executed_op_global_ld.sum                             393216.000
smsp__sass_inst_executed_op_shared_st.sum                                  0.000
smsp__sass_inst_executed_op_shared_ld.sum                                  0.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x256_32x3_tn_align4EEvNT_6ParamsE<<<{128, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__sass_data_bytes_mem_global_op_st.sum                          12582912.000
smsp__sass_data_bytes_mem_global_op_ld.sum                           6291456.000
smsp__sass_inst_executed_op_ldgsts.sum                                884736.000
smsp__sass_inst_executed_op_global_st.sum                              24576.000
smsp__sass_inst_executed_op_global_ld.sum                              24576.000
smsp__sass_inst_executed_op_shared_st.sum                              49152.000
smsp__sass_inst_executed_op_shared_ld.sum                              24576.000
-----------------------------------------------------------------------------------
Range Name: residual2
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__sass_data_bytes_mem_global_op_st.sum                          12582912.000
smsp__sass_data_bytes_mem_global_op_ld.sum                          25165824.000
smsp__sass_inst_executed_op_ldgsts.sum                                     0.000
smsp__sass_inst_executed_op_global_st.sum                              98304.000
smsp__sass_inst_executed_op_global_ld.sum                             196608.000
smsp__sass_inst_executed_op_shared_st.sum                                  0.000
smsp__sass_inst_executed_op_shared_ld.sum                                  0.000
-----------------------------------------------------------------------------------
Range Name: vecadd
======================================================================================
Kernel: _Z6vecAddPKfS0_Pfi<<<{12288, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__sass_data_bytes_mem_global_op_st.sum                          12582912.000
smsp__sass_data_bytes_mem_global_op_ld.sum                          25165824.000
smsp__sass_inst_executed_op_ldgsts.sum                                     0.000
smsp__sass_inst_executed_op_global_st.sum                              98304.000
smsp__sass_inst_executed_op_global_ld.sum                             196608.000
smsp__sass_inst_executed_op_shared_st.sum                                  0.000
smsp__sass_inst_executed_op_shared_ld.sum                                  0.000
-----------------------------------------------------------------------------------
Range Name: vecadd_thrust
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__sass_data_bytes_mem_global_op_st.sum                          12582912.000
smsp__sass_data_bytes_mem_global_op_ld.sum                          25165824.000
smsp__sass_inst_executed_op_ldgsts.sum                                     0.000
smsp__sass_inst_executed_op_global_st.sum                              98304.000
smsp__sass_inst_executed_op_global_ld.sum                             196608.000
smsp__sass_inst_executed_op_shared_st.sum                                  0.000
smsp__sass_inst_executed_op_shared_ld.sum                                  0.000
-----------------------------------------------------------------------------------
==> ./train_gpt2cu 2 sm__pipe_alu_cycles_active.max sm__pipe_fma_cycles_active.max
Adding metric: sm__pipe_alu_cycles_active.max
Adding metric: sm__pipe_fma_cycles_active.max
Setting output path: ./output/result.csv
input dataset prefix: data/tiny_shakespeare
output log file: NULL
batch size B: 4
sequence length T: 1024
learning rate: 0.000100
val_loss_every: 20
val_max_batches: 20
sample_every: 20
genT: 64
[System]
Device 0: NVIDIA A100-SXM4-40GB
enable_tf32: 1
[GPT-2]
max_seq_len: 1024
vocab_size: 50257
num_layers: 12
num_heads: 12
channels: 768
num_parameters: 124439808
allocated 474 MiB for model parameters
train dataset num_batches: 74
val dataset num_batches: 8
Initializing CUDA driver...
Compute Capability of Device: 8.0
Num of Passes: 1
Forward pass 0
num_activations: 1868386304
allocated 7127 MiB for activations
allocated 474 MiB for parameter gradients
allocated 1421 MiB for activation gradients
allocated 474 MiB for AdamW optimizer state m
allocated 474 MiB for AdamW optimizer state v
step 1/2: train loss 9.130970 (145.234257 ms)
Forward pass 1
step 2/2: train loss 8.668051 (478.706252 ms)
total average iteration time: 311.970255 ms
Number of ranges: 17
m_profilerRanges size: 17
Range Name: encoder_forward
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tEiZ15encoder_forwardPfRKN6thrust20THRUST_200700_800_NS13device_vectorIiNS8_16device_allocatorIiEEEES6_S6_iiiiEUliE_EEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_fma_cycles_active.max                                         50592.000
sm__pipe_alu_cycles_active.max                                         54560.000
-----------------------------------------------------------------------------------
Range Name: ln1
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_fma_cycles_active.max                                         25824.000
sm__pipe_alu_cycles_active.max                                         47520.000
-----------------------------------------------------------------------------------
Range Name: attention
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_fma_cycles_active.max                                        180400.000
sm__pipe_alu_cycles_active.max                                        218888.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElNS2_12op_wrapper_tIlZ17attention_forwardPfS7_S7_S7_S7_S7_iiiiEUliE_N6thrust20THRUST_200700_800_NS17counting_iteratorIiNSA_11use_defaultESC_SC_EEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_fma_cycles_active.max                                         71248.000
sm__pipe_alu_cycles_active.max                                         72224.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I51cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4EEvNT_6ParamsE<<<{64, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_fma_cycles_active.max                                        144128.000
sm__pipe_alu_cycles_active.max                                        218368.000
-----------------------------------------------------------------------------------
Kernel: _Z23softmax_forward_kernel5PffPKfii<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_fma_cycles_active.max                                        211400.000
sm__pipe_alu_cycles_active.max                                        270832.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I50cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4EEvNT_6ParamsE<<<{16, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_fma_cycles_active.max                                        151680.000
sm__pipe_alu_cycles_active.max                                        218240.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEENS7_20permutation_iteratorIPfNS7_18transform_iteratorIZ17attention_forwardSF_SF_SF_SF_SF_SF_iiiiEUliE0_NS7_17counting_iteratorIiNS7_11use_defaultESJ_SJ_EESJ_SJ_EEEENS9_14no_stencil_tagENS8_8identityENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_fma_cycles_active.max                                         66816.000
sm__pipe_alu_cycles_active.max                                         70528.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 1, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_fma_cycles_active.max                                         60112.000
sm__pipe_alu_cycles_active.max                                         72888.000
-----------------------------------------------------------------------------------
Range Name: residual1
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_fma_cycles_active.max                                          8192.000
sm__pipe_alu_cycles_active.max                                         19456.000
-----------------------------------------------------------------------------------
Range Name: ln2
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_fma_cycles_active.max                                         25824.000
sm__pipe_alu_cycles_active.max                                         47520.000
-----------------------------------------------------------------------------------
Range Name: ff
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_fma_cycles_active.max                                        240256.000
sm__pipe_alu_cycles_active.max                                        290880.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fIPKfPfNS9_14no_stencil_tagEZ12gelu_forwardSD_SC_iEUlfE_NS9_21always_true_predicateEEEEEvT0_T1_<<<{24576, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_fma_cycles_active.max                                         59040.000
sm__pipe_alu_cycles_active.max                                         51168.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x256_32x3_tn_align4EEvNT_6ParamsE<<<{128, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_fma_cycles_active.max                                        219888.000
sm__pipe_alu_cycles_active.max                                        244640.000
-----------------------------------------------------------------------------------
Range Name: residual2
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_fma_cycles_active.max                                          8320.000
sm__pipe_alu_cycles_active.max                                         19760.000
-----------------------------------------------------------------------------------
Range Name: vecadd
======================================================================================
Kernel: _Z6vecAddPKfS0_Pfi<<<{12288, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_fma_cycles_active.max                                         10080.000
sm__pipe_alu_cycles_active.max                                          4032.000
-----------------------------------------------------------------------------------
Range Name: vecadd_thrust
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_fma_cycles_active.max                                          8320.000
sm__pipe_alu_cycles_active.max                                         19760.000
-----------------------------------------------------------------------------------
==> ./train_gpt2cu 2 sm__sass_inst_executed_op_ldgsts_cache_access.sum sm__sass_inst_executed_op_ldgsts_cache_bypass.sum
Adding metric: sm__sass_inst_executed_op_ldgsts_cache_access.sum
Adding metric: sm__sass_inst_executed_op_ldgsts_cache_bypass.sum
Setting output path: ./output/result.csv
input dataset prefix: data/tiny_shakespeare
output log file: NULL
batch size B: 4
sequence length T: 1024
learning rate: 0.000100
val_loss_every: 20
val_max_batches: 20
sample_every: 20
genT: 64
[System]
Device 0: NVIDIA A100-SXM4-40GB
enable_tf32: 1
[GPT-2]
max_seq_len: 1024
vocab_size: 50257
num_layers: 12
num_heads: 12
channels: 768
num_parameters: 124439808
allocated 474 MiB for model parameters
train dataset num_batches: 74
val dataset num_batches: 8
Initializing CUDA driver...
Compute Capability of Device: 8.0
Num of Passes: 1
Forward pass 0
num_activations: 1868386304
allocated 7127 MiB for activations
allocated 474 MiB for parameter gradients
allocated 1421 MiB for activation gradients
allocated 474 MiB for AdamW optimizer state m
allocated 474 MiB for AdamW optimizer state v
step 1/2: train loss 9.130970 (147.603104 ms)
Forward pass 1
step 2/2: train loss 8.668050 (1286.013612 ms)
total average iteration time: 716.808358 ms
Number of ranges: 17
m_profilerRanges size: 17
Range Name: encoder_forward
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tEiZ15encoder_forwardPfRKN6thrust20THRUST_200700_800_NS13device_vectorIiNS8_16device_allocatorIiEEEES6_S6_iiiiEUliE_EEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_inst_executed_op_ldgsts_cache_bypass.sum                          0.000
sm__sass_inst_executed_op_ldgsts_cache_access.sum                          0.000
-----------------------------------------------------------------------------------
Range Name: ln1
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_inst_executed_op_ldgsts_cache_bypass.sum                          0.000
sm__sass_inst_executed_op_ldgsts_cache_access.sum                          0.000
-----------------------------------------------------------------------------------
Range Name: attention
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_inst_executed_op_ldgsts_cache_bypass.sum                     884736.000
sm__sass_inst_executed_op_ldgsts_cache_access.sum                          0.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElNS2_12op_wrapper_tIlZ17attention_forwardPfS7_S7_S7_S7_S7_iiiiEUliE_N6thrust20THRUST_200700_800_NS17counting_iteratorIiNSA_11use_defaultESC_SC_EEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_inst_executed_op_ldgsts_cache_bypass.sum                          0.000
sm__sass_inst_executed_op_ldgsts_cache_access.sum                          0.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I51cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4EEvNT_6ParamsE<<<{64, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_inst_executed_op_ldgsts_cache_bypass.sum                     491520.000
sm__sass_inst_executed_op_ldgsts_cache_access.sum                          0.000
-----------------------------------------------------------------------------------
Kernel: _Z23softmax_forward_kernel5PffPKfii<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_inst_executed_op_ldgsts_cache_bypass.sum                          0.000
sm__sass_inst_executed_op_ldgsts_cache_access.sum                          0.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I50cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4EEvNT_6ParamsE<<<{16, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_inst_executed_op_ldgsts_cache_bypass.sum                     786432.000
sm__sass_inst_executed_op_ldgsts_cache_access.sum                          0.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEENS7_20permutation_iteratorIPfNS7_18transform_iteratorIZ17attention_forwardSF_SF_SF_SF_SF_SF_iiiiEUliE0_NS7_17counting_iteratorIiNS7_11use_defaultESJ_SJ_EESJ_SJ_EEEENS9_14no_stencil_tagENS8_8identityENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_inst_executed_op_ldgsts_cache_bypass.sum                          0.000
sm__sass_inst_executed_op_ldgsts_cache_access.sum                          0.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 1, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_inst_executed_op_ldgsts_cache_bypass.sum                     294912.000
sm__sass_inst_executed_op_ldgsts_cache_access.sum                          0.000
-----------------------------------------------------------------------------------
Range Name: residual1
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_inst_executed_op_ldgsts_cache_bypass.sum                          0.000
sm__sass_inst_executed_op_ldgsts_cache_access.sum                          0.000
-----------------------------------------------------------------------------------
Range Name: ln2
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_inst_executed_op_ldgsts_cache_bypass.sum                          0.000
sm__sass_inst_executed_op_ldgsts_cache_access.sum                          0.000
-----------------------------------------------------------------------------------
Range Name: ff
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_inst_executed_op_ldgsts_cache_bypass.sum                    1179648.000
sm__sass_inst_executed_op_ldgsts_cache_access.sum                          0.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fIPKfPfNS9_14no_stencil_tagEZ12gelu_forwardSD_SC_iEUlfE_NS9_21always_true_predicateEEEEEvT0_T1_<<<{24576, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_inst_executed_op_ldgsts_cache_bypass.sum                          0.000
sm__sass_inst_executed_op_ldgsts_cache_access.sum                          0.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x256_32x3_tn_align4EEvNT_6ParamsE<<<{128, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_inst_executed_op_ldgsts_cache_bypass.sum                     884736.000
sm__sass_inst_executed_op_ldgsts_cache_access.sum                          0.000
-----------------------------------------------------------------------------------
Range Name: residual2
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_inst_executed_op_ldgsts_cache_bypass.sum                          0.000
sm__sass_inst_executed_op_ldgsts_cache_access.sum                          0.000
-----------------------------------------------------------------------------------
Range Name: vecadd
======================================================================================
Kernel: _Z6vecAddPKfS0_Pfi<<<{12288, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_inst_executed_op_ldgsts_cache_bypass.sum                          0.000
sm__sass_inst_executed_op_ldgsts_cache_access.sum                          0.000
-----------------------------------------------------------------------------------
Range Name: vecadd_thrust
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_inst_executed_op_ldgsts_cache_bypass.sum                          0.000
sm__sass_inst_executed_op_ldgsts_cache_access.sum                          0.000
-----------------------------------------------------------------------------------
==> ./train_gpt2cu 2 sm__threads_launched.sum sm__warps_active.sum
Adding metric: sm__threads_launched.sum
Adding metric: sm__warps_active.sum
Setting output path: ./output/result.csv
input dataset prefix: data/tiny_shakespeare
output log file: NULL
batch size B: 4
sequence length T: 1024
learning rate: 0.000100
val_loss_every: 20
val_max_batches: 20
sample_every: 20
genT: 64
[System]
Device 0: NVIDIA A100-SXM4-40GB
enable_tf32: 1
[GPT-2]
max_seq_len: 1024
vocab_size: 50257
num_layers: 12
num_heads: 12
channels: 768
num_parameters: 124439808
allocated 474 MiB for model parameters
train dataset num_batches: 74
val dataset num_batches: 8
Initializing CUDA driver...
Compute Capability of Device: 8.0
Num of Passes: 1
Forward pass 0
num_activations: 1868386304
allocated 7127 MiB for activations
allocated 474 MiB for parameter gradients
allocated 1421 MiB for activation gradients
allocated 474 MiB for AdamW optimizer state m
allocated 474 MiB for AdamW optimizer state v
step 1/2: train loss 9.130970 (146.859988 ms)
Forward pass 1
step 2/2: train loss 8.668048 (827.893050 ms)
total average iteration time: 487.376519 ms
Number of ranges: 17
m_profilerRanges size: 17
Range Name: encoder_forward
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tEiZ15encoder_forwardPfRKN6thrust20THRUST_200700_800_NS13device_vectorIiNS8_16device_allocatorIiEEEES6_S6_iiiiEUliE_EEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__warps_active.sum                                               169781878.000
sm__threads_launched.sum                                             1572864.000
-----------------------------------------------------------------------------------
Range Name: ln1
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__warps_active.sum                                               112042600.000
sm__threads_launched.sum                                              131072.000
-----------------------------------------------------------------------------------
Range Name: attention
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__warps_active.sum                                               135736674.000
sm__threads_launched.sum                                               98304.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElNS2_12op_wrapper_tIlZ17attention_forwardPfS7_S7_S7_S7_S7_iiiiEUliE_N6thrust20THRUST_200700_800_NS17counting_iteratorIiNSA_11use_defaultESC_SC_EEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__warps_active.sum                                               502415908.000
sm__threads_launched.sum                                             1572864.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I51cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4EEvNT_6ParamsE<<<{64, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__warps_active.sum                                               211386554.000
sm__threads_launched.sum                                              393216.000
-----------------------------------------------------------------------------------
Kernel: _Z23softmax_forward_kernel5PffPKfii<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__warps_active.sum                                              1206543868.000
sm__threads_launched.sum                                             1572864.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I50cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4EEvNT_6ParamsE<<<{16, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__warps_active.sum                                               301568536.000
sm__threads_launched.sum                                               98304.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEENS7_20permutation_iteratorIPfNS7_18transform_iteratorIZ17attention_forwardSF_SF_SF_SF_SF_SF_iiiiEUliE0_NS7_17counting_iteratorIiNS7_11use_defaultESJ_SJ_EESJ_SJ_EEEENS9_14no_stencil_tagENS8_8identityENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__warps_active.sum                                               147354700.000
sm__threads_launched.sum                                             1572864.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 1, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__warps_active.sum                                                43075228.000
sm__threads_launched.sum                                               32768.000
-----------------------------------------------------------------------------------
Range Name: residual1
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__warps_active.sum                                               170623226.000
sm__threads_launched.sum                                             1572864.000
-----------------------------------------------------------------------------------
Range Name: ln2
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__warps_active.sum                                               116800476.000
sm__threads_launched.sum                                              131072.000
-----------------------------------------------------------------------------------
Range Name: ff
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__warps_active.sum                                               181201358.000
sm__threads_launched.sum                                               98304.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fIPKfPfNS9_14no_stencil_tagEZ12gelu_forwardSD_SC_iEUlfE_NS9_21always_true_predicateEEEEEvT0_T1_<<<{24576, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__warps_active.sum                                               665080262.000
sm__threads_launched.sum                                             6291456.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x256_32x3_tn_align4EEvNT_6ParamsE<<<{128, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__warps_active.sum                                               166777062.000
sm__threads_launched.sum                                               32768.000
-----------------------------------------------------------------------------------
Range Name: residual2
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__warps_active.sum                                               132107064.000
sm__threads_launched.sum                                             1572864.000
-----------------------------------------------------------------------------------
Range Name: vecadd
======================================================================================
Kernel: _Z6vecAddPKfS0_Pfi<<<{12288, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__warps_active.sum                                               180685062.000
sm__threads_launched.sum                                             3145728.000
-----------------------------------------------------------------------------------
Range Name: vecadd_thrust
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__warps_active.sum                                               133071092.000
sm__threads_launched.sum                                             1572864.000
-----------------------------------------------------------------------------------
==> ./train_gpt2cu 2 sm__pipe_tensor_cycles_active.max sm__pipe_shared_cycles_active.max
Adding metric: sm__pipe_tensor_cycles_active.max
Adding metric: sm__pipe_shared_cycles_active.max
Setting output path: ./output/result.csv
input dataset prefix: data/tiny_shakespeare
output log file: NULL
batch size B: 4
sequence length T: 1024
learning rate: 0.000100
val_loss_every: 20
val_max_batches: 20
sample_every: 20
genT: 64
[System]
Device 0: NVIDIA A100-SXM4-40GB
enable_tf32: 1
[GPT-2]
max_seq_len: 1024
vocab_size: 50257
num_layers: 12
num_heads: 12
channels: 768
num_parameters: 124439808
allocated 474 MiB for model parameters
train dataset num_batches: 74
val dataset num_batches: 8
Initializing CUDA driver...
Compute Capability of Device: 8.0
Num of Passes: 1
Forward pass 0
num_activations: 1868386304
allocated 7127 MiB for activations
allocated 474 MiB for parameter gradients
allocated 1421 MiB for activation gradients
allocated 474 MiB for AdamW optimizer state m
allocated 474 MiB for AdamW optimizer state v
step 1/2: train loss 9.130970 (147.310119 ms)
Forward pass 1
step 2/2: train loss 8.668051 (480.021402 ms)
total average iteration time: 313.665760 ms
Number of ranges: 17
m_profilerRanges size: 17
Range Name: encoder_forward
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tEiZ15encoder_forwardPfRKN6thrust20THRUST_200700_800_NS13device_vectorIiNS8_16device_allocatorIiEEEES6_S6_iiiiEUliE_EEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_shared_cycles_active.max                                          0.000
sm__pipe_tensor_cycles_active.max                                          0.000
-----------------------------------------------------------------------------------
Range Name: ln1
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_shared_cycles_active.max                                          0.000
sm__pipe_tensor_cycles_active.max                                          0.000
-----------------------------------------------------------------------------------
Range Name: attention
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_shared_cycles_active.max                                     589824.000
sm__pipe_tensor_cycles_active.max                                     589824.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElNS2_12op_wrapper_tIlZ17attention_forwardPfS7_S7_S7_S7_S7_iiiiEUliE_N6thrust20THRUST_200700_800_NS17counting_iteratorIiNSA_11use_defaultESC_SC_EEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_shared_cycles_active.max                                          0.000
sm__pipe_tensor_cycles_active.max                                          0.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I51cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4EEvNT_6ParamsE<<<{64, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_shared_cycles_active.max                                     262144.000
sm__pipe_tensor_cycles_active.max                                     262144.000
-----------------------------------------------------------------------------------
Kernel: _Z23softmax_forward_kernel5PffPKfii<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_shared_cycles_active.max                                       2416.000
sm__pipe_tensor_cycles_active.max                                       2416.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I50cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4EEvNT_6ParamsE<<<{16, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_shared_cycles_active.max                                     262144.000
sm__pipe_tensor_cycles_active.max                                     262144.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEENS7_20permutation_iteratorIPfNS7_18transform_iteratorIZ17attention_forwardSF_SF_SF_SF_SF_SF_iiiiEUliE0_NS7_17counting_iteratorIiNS7_11use_defaultESJ_SJ_EESJ_SJ_EEEENS9_14no_stencil_tagENS8_8identityENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_shared_cycles_active.max                                        928.000
sm__pipe_tensor_cycles_active.max                                        928.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 1, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_shared_cycles_active.max                                     196608.000
sm__pipe_tensor_cycles_active.max                                     196608.000
-----------------------------------------------------------------------------------
Range Name: residual1
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_shared_cycles_active.max                                          0.000
sm__pipe_tensor_cycles_active.max                                          0.000
-----------------------------------------------------------------------------------
Range Name: ln2
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_shared_cycles_active.max                                          0.000
sm__pipe_tensor_cycles_active.max                                          0.000
-----------------------------------------------------------------------------------
Range Name: ff
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_shared_cycles_active.max                                     786432.000
sm__pipe_tensor_cycles_active.max                                     786432.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fIPKfPfNS9_14no_stencil_tagEZ12gelu_forwardSD_SC_iEUlfE_NS9_21always_true_predicateEEEEEvT0_T1_<<<{24576, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_shared_cycles_active.max                                          0.000
sm__pipe_tensor_cycles_active.max                                          0.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x256_32x3_tn_align4EEvNT_6ParamsE<<<{128, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_shared_cycles_active.max                                     786432.000
sm__pipe_tensor_cycles_active.max                                     786432.000
-----------------------------------------------------------------------------------
Range Name: residual2
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_shared_cycles_active.max                                          0.000
sm__pipe_tensor_cycles_active.max                                          0.000
-----------------------------------------------------------------------------------
Range Name: vecadd
======================================================================================
Kernel: _Z6vecAddPKfS0_Pfi<<<{12288, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_shared_cycles_active.max                                       2080.000
sm__pipe_tensor_cycles_active.max                                       2080.000
-----------------------------------------------------------------------------------
Range Name: vecadd_thrust
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__pipe_shared_cycles_active.max                                          0.000
sm__pipe_tensor_cycles_active.max                                          0.000
-----------------------------------------------------------------------------------
==> ./train_gpt2cu 2 l1tex__t_requests_pipe_lsu_mem_global_op_ld.sum
Adding metric: l1tex__t_requests_pipe_lsu_mem_global_op_ld.sum
Setting output path: ./output/result.csv
input dataset prefix: data/tiny_shakespeare
output log file: NULL
batch size B: 4
sequence length T: 1024
learning rate: 0.000100
val_loss_every: 20
val_max_batches: 20
sample_every: 20
genT: 64
[System]
Device 0: NVIDIA A100-SXM4-40GB
enable_tf32: 1
[GPT-2]
max_seq_len: 1024
vocab_size: 50257
num_layers: 12
num_heads: 12
channels: 768
num_parameters: 124439808
allocated 474 MiB for model parameters
train dataset num_batches: 74
val dataset num_batches: 8
Initializing CUDA driver...
Compute Capability of Device: 8.0
Num of Passes: 1
Forward pass 0
num_activations: 1868386304
allocated 7127 MiB for activations
allocated 474 MiB for parameter gradients
allocated 1421 MiB for activation gradients
allocated 474 MiB for AdamW optimizer state m
allocated 474 MiB for AdamW optimizer state v
step 1/2: train loss 9.130970 (145.398365 ms)
Forward pass 1
step 2/2: train loss 8.668053 (478.375939 ms)
total average iteration time: 311.887152 ms
Number of ranges: 17
m_profilerRanges size: 17
Range Name: encoder_forward
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tEiZ15encoder_forwardPfRKN6thrust20THRUST_200700_800_NS13device_vectorIiNS8_16device_allocatorIiEEEES6_S6_iiiiEUliE_EEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_ld.sum                       294912.000
-----------------------------------------------------------------------------------
Range Name: ln1
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_ld.sum                       491520.000
-----------------------------------------------------------------------------------
Range Name: attention
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_ld.sum                       958464.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElNS2_12op_wrapper_tIlZ17attention_forwardPfS7_S7_S7_S7_S7_iiiiEUliE_N6thrust20THRUST_200700_800_NS17counting_iteratorIiNSA_11use_defaultESC_SC_EEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_ld.sum                       294912.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I51cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4EEvNT_6ParamsE<<<{64, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_ld.sum                       491520.000
-----------------------------------------------------------------------------------
Kernel: _Z23softmax_forward_kernel5PffPKfii<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_ld.sum                      1115520.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I50cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4EEvNT_6ParamsE<<<{16, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_ld.sum                       786432.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEENS7_20permutation_iteratorIPfNS7_18transform_iteratorIZ17attention_forwardSF_SF_SF_SF_SF_SF_iiiiEUliE0_NS7_17counting_iteratorIiNS7_11use_defaultESJ_SJ_EESJ_SJ_EEEENS9_14no_stencil_tagENS8_8identityENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_ld.sum                        98304.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 1, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_ld.sum                       319488.000
-----------------------------------------------------------------------------------
Range Name: residual1
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_ld.sum                       196608.000
-----------------------------------------------------------------------------------
Range Name: ln2
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_ld.sum                       491520.000
-----------------------------------------------------------------------------------
Range Name: ff
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_ld.sum                      1277952.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fIPKfPfNS9_14no_stencil_tagEZ12gelu_forwardSD_SC_iEUlfE_NS9_21always_true_predicateEEEEEvT0_T1_<<<{24576, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_ld.sum                       393216.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x256_32x3_tn_align4EEvNT_6ParamsE<<<{128, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_ld.sum                       909312.000
-----------------------------------------------------------------------------------
Range Name: residual2
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_ld.sum                       196608.000
-----------------------------------------------------------------------------------
Range Name: vecadd
======================================================================================
Kernel: _Z6vecAddPKfS0_Pfi<<<{12288, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_ld.sum                       196608.000
-----------------------------------------------------------------------------------
Range Name: vecadd_thrust
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_ld.sum                       196608.000
-----------------------------------------------------------------------------------
==> ./train_gpt2cu 2 l1tex__t_requests_pipe_lsu_mem_global_op_st.sum
Adding metric: l1tex__t_requests_pipe_lsu_mem_global_op_st.sum
Setting output path: ./output/result.csv
input dataset prefix: data/tiny_shakespeare
output log file: NULL
batch size B: 4
sequence length T: 1024
learning rate: 0.000100
val_loss_every: 20
val_max_batches: 20
sample_every: 20
genT: 64
[System]
Device 0: NVIDIA A100-SXM4-40GB
enable_tf32: 1
[GPT-2]
max_seq_len: 1024
vocab_size: 50257
num_layers: 12
num_heads: 12
channels: 768
num_parameters: 124439808
allocated 474 MiB for model parameters
train dataset num_batches: 74
val dataset num_batches: 8
Initializing CUDA driver...
Compute Capability of Device: 8.0
Num of Passes: 1
Forward pass 0
num_activations: 1868386304
allocated 7127 MiB for activations
allocated 474 MiB for parameter gradients
allocated 1421 MiB for activation gradients
allocated 474 MiB for AdamW optimizer state m
allocated 474 MiB for AdamW optimizer state v
step 1/2: train loss 9.130970 (145.861404 ms)
Forward pass 1
step 2/2: train loss 8.668051 (487.629099 ms)
total average iteration time: 316.745251 ms
Number of ranges: 17
m_profilerRanges size: 17
Range Name: encoder_forward
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tEiZ15encoder_forwardPfRKN6thrust20THRUST_200700_800_NS13device_vectorIiNS8_16device_allocatorIiEEEES6_S6_iiiiEUliE_EEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_st.sum                        98304.000
-----------------------------------------------------------------------------------
Range Name: ln1
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_st.sum                       106496.000
-----------------------------------------------------------------------------------
Range Name: attention
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_st.sum                        73728.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElNS2_12op_wrapper_tIlZ17attention_forwardPfS7_S7_S7_S7_S7_iiiiEUliE_N6thrust20THRUST_200700_800_NS17counting_iteratorIiNSA_11use_defaultESC_SC_EEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_st.sum                       294912.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I51cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4EEvNT_6ParamsE<<<{64, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_st.sum                       393216.000
-----------------------------------------------------------------------------------
Kernel: _Z23softmax_forward_kernel5PffPKfii<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_st.sum                       811008.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I50cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4EEvNT_6ParamsE<<<{16, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_st.sum                        24576.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEENS7_20permutation_iteratorIPfNS7_18transform_iteratorIZ17attention_forwardSF_SF_SF_SF_SF_SF_iiiiEUliE0_NS7_17counting_iteratorIiNS7_11use_defaultESJ_SJ_EESJ_SJ_EEEENS9_14no_stencil_tagENS8_8identityENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_st.sum                        98304.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 1, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_st.sum                        24576.000
-----------------------------------------------------------------------------------
Range Name: residual1
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_st.sum                        98304.000
-----------------------------------------------------------------------------------
Range Name: ln2
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_st.sum                       106496.000
-----------------------------------------------------------------------------------
Range Name: ff
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_st.sum                        98304.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fIPKfPfNS9_14no_stencil_tagEZ12gelu_forwardSD_SC_iEUlfE_NS9_21always_true_predicateEEEEEvT0_T1_<<<{24576, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_st.sum                       393216.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x256_32x3_tn_align4EEvNT_6ParamsE<<<{128, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_st.sum                        24576.000
-----------------------------------------------------------------------------------
Range Name: residual2
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_st.sum                        98304.000
-----------------------------------------------------------------------------------
Range Name: vecadd
======================================================================================
Kernel: _Z6vecAddPKfS0_Pfi<<<{12288, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_st.sum                        98304.000
-----------------------------------------------------------------------------------
Range Name: vecadd_thrust
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_requests_pipe_lsu_mem_global_op_st.sum                        98304.000
-----------------------------------------------------------------------------------
==> ./train_gpt2cu 2 l1tex__t_sectors_pipe_lsu_mem_global_op_ld.sum l1tex__t_sectors_pipe_lsu_mem_global_op_st.sum
Adding metric: l1tex__t_sectors_pipe_lsu_mem_global_op_ld.sum
Adding metric: l1tex__t_sectors_pipe_lsu_mem_global_op_st.sum
Setting output path: ./output/result.csv
input dataset prefix: data/tiny_shakespeare
output log file: NULL
batch size B: 4
sequence length T: 1024
learning rate: 0.000100
val_loss_every: 20
val_max_batches: 20
sample_every: 20
genT: 64
[System]
Device 0: NVIDIA A100-SXM4-40GB
enable_tf32: 1
[GPT-2]
max_seq_len: 1024
vocab_size: 50257
num_layers: 12
num_heads: 12
channels: 768
num_parameters: 124439808
allocated 474 MiB for model parameters
train dataset num_batches: 74
val dataset num_batches: 8
Initializing CUDA driver...
Compute Capability of Device: 8.0
Num of Passes: 1
Forward pass 0
num_activations: 1868386304
allocated 7127 MiB for activations
allocated 474 MiB for parameter gradients
allocated 1421 MiB for activation gradients
allocated 474 MiB for AdamW optimizer state m
allocated 474 MiB for AdamW optimizer state v
step 1/2: train loss 9.130970 (146.178552 ms)
Forward pass 1
step 2/2: train loss 8.668056 (444.968021 ms)
total average iteration time: 295.573286 ms
Number of ranges: 17
m_profilerRanges size: 17
Range Name: encoder_forward
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tEiZ15encoder_forwardPfRKN6thrust20THRUST_200700_800_NS13device_vectorIiNS8_16device_allocatorIiEEEES6_S6_iiiiEUliE_EEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_sectors_pipe_lsu_mem_global_op_st.sum                        393216.000
l1tex__t_sectors_pipe_lsu_mem_global_op_ld.sum                        884736.000
-----------------------------------------------------------------------------------
Range Name: ln1
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_sectors_pipe_lsu_mem_global_op_st.sum                        401408.000
l1tex__t_sectors_pipe_lsu_mem_global_op_ld.sum                       1966080.000
-----------------------------------------------------------------------------------
Range Name: attention
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_sectors_pipe_lsu_mem_global_op_st.sum                       1179648.000
l1tex__t_sectors_pipe_lsu_mem_global_op_ld.sum                      14745600.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElNS2_12op_wrapper_tIlZ17attention_forwardPfS7_S7_S7_S7_S7_iiiiEUliE_N6thrust20THRUST_200700_800_NS17counting_iteratorIiNSA_11use_defaultESC_SC_EEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_sectors_pipe_lsu_mem_global_op_st.sum                       1179648.000
l1tex__t_sectors_pipe_lsu_mem_global_op_ld.sum                       1179648.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I51cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4EEvNT_6ParamsE<<<{64, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_sectors_pipe_lsu_mem_global_op_st.sum                       6291456.000
l1tex__t_sectors_pipe_lsu_mem_global_op_ld.sum                       7864320.000
-----------------------------------------------------------------------------------
Kernel: _Z23softmax_forward_kernel5PffPKfii<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_sectors_pipe_lsu_mem_global_op_st.sum                       3170304.000
l1tex__t_sectors_pipe_lsu_mem_global_op_ld.sum                       6389976.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I50cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4EEvNT_6ParamsE<<<{16, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_sectors_pipe_lsu_mem_global_op_st.sum                        393216.000
l1tex__t_sectors_pipe_lsu_mem_global_op_ld.sum                      12582912.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEENS7_20permutation_iteratorIPfNS7_18transform_iteratorIZ17attention_forwardSF_SF_SF_SF_SF_SF_iiiiEUliE0_NS7_17counting_iteratorIiNS7_11use_defaultESJ_SJ_EESJ_SJ_EEEENS9_14no_stencil_tagENS8_8identityENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_sectors_pipe_lsu_mem_global_op_st.sum                        393216.000
l1tex__t_sectors_pipe_lsu_mem_global_op_ld.sum                        393216.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 1, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_sectors_pipe_lsu_mem_global_op_st.sum                        393216.000
l1tex__t_sectors_pipe_lsu_mem_global_op_ld.sum                       4915200.000
-----------------------------------------------------------------------------------
Range Name: residual1
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_sectors_pipe_lsu_mem_global_op_st.sum                        393216.000
l1tex__t_sectors_pipe_lsu_mem_global_op_ld.sum                        786432.000
-----------------------------------------------------------------------------------
Range Name: ln2
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_sectors_pipe_lsu_mem_global_op_st.sum                        401408.000
l1tex__t_sectors_pipe_lsu_mem_global_op_ld.sum                       1966080.000
-----------------------------------------------------------------------------------
Range Name: ff
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_sectors_pipe_lsu_mem_global_op_st.sum                       1572864.000
l1tex__t_sectors_pipe_lsu_mem_global_op_ld.sum                      19660800.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fIPKfPfNS9_14no_stencil_tagEZ12gelu_forwardSD_SC_iEUlfE_NS9_21always_true_predicateEEEEEvT0_T1_<<<{24576, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_sectors_pipe_lsu_mem_global_op_st.sum                       1572864.000
l1tex__t_sectors_pipe_lsu_mem_global_op_ld.sum                       1572864.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x256_32x3_tn_align4EEvNT_6ParamsE<<<{128, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_sectors_pipe_lsu_mem_global_op_st.sum                        393216.000
l1tex__t_sectors_pipe_lsu_mem_global_op_ld.sum                      14352384.000
-----------------------------------------------------------------------------------
Range Name: residual2
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_sectors_pipe_lsu_mem_global_op_st.sum                        393216.000
l1tex__t_sectors_pipe_lsu_mem_global_op_ld.sum                        786432.000
-----------------------------------------------------------------------------------
Range Name: vecadd
======================================================================================
Kernel: _Z6vecAddPKfS0_Pfi<<<{12288, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_sectors_pipe_lsu_mem_global_op_st.sum                        393216.000
l1tex__t_sectors_pipe_lsu_mem_global_op_ld.sum                        786432.000
-----------------------------------------------------------------------------------
Range Name: vecadd_thrust
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
l1tex__t_sectors_pipe_lsu_mem_global_op_st.sum                        393216.000
l1tex__t_sectors_pipe_lsu_mem_global_op_ld.sum                        786432.000
-----------------------------------------------------------------------------------
==> ./train_gpt2cu 2 sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_access.sum sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_access.sum sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum
Adding metric: sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_access.sum
Adding metric: sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_access.sum
Adding metric: sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum
Adding metric: sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum
Setting output path: ./output/result.csv
input dataset prefix: data/tiny_shakespeare
output log file: NULL
batch size B: 4
sequence length T: 1024
learning rate: 0.000100
val_loss_every: 20
val_max_batches: 20
sample_every: 20
genT: 64
[System]
Device 0: NVIDIA A100-SXM4-40GB
enable_tf32: 1
[GPT-2]
max_seq_len: 1024
vocab_size: 50257
num_layers: 12
num_heads: 12
channels: 768
num_parameters: 124439808
allocated 474 MiB for model parameters
train dataset num_batches: 74
val dataset num_batches: 8
Initializing CUDA driver...
Compute Capability of Device: 8.0
Num of Passes: 1
Forward pass 0
num_activations: 1868386304
allocated 7127 MiB for activations
allocated 474 MiB for parameter gradients
allocated 1421 MiB for activation gradients
allocated 474 MiB for AdamW optimizer state m
allocated 474 MiB for AdamW optimizer state v
step 1/2: train loss 9.130970 (147.153952 ms)
Forward pass 1
step 2/2: train loss 8.668048 (1300.222277 ms)
total average iteration time: 723.688114 ms
Number of ranges: 17
m_profilerRanges size: 17
Range Name: encoder_forward
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tEiZ15encoder_forwardPfRKN6thrust20THRUST_200700_800_NS13device_vectorIiNS8_16device_allocatorIiEEEES6_S6_iiiiEUliE_EEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                         0.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                         0.000
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
-----------------------------------------------------------------------------------
Range Name: ln1
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                         0.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                         0.000
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
-----------------------------------------------------------------------------------
Range Name: attention
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                  10913088.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                    884736.000
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElNS2_12op_wrapper_tIlZ17attention_forwardPfS7_S7_S7_S7_S7_iiiiEUliE_N6thrust20THRUST_200700_800_NS17counting_iteratorIiNSA_11use_defaultESC_SC_EEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                         0.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                         0.000
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I51cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4EEvNT_6ParamsE<<<{64, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                   7280464.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                    491520.000
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
-----------------------------------------------------------------------------------
Kernel: _Z23softmax_forward_kernel5PffPKfii<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                         0.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                         0.000
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I50cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4EEvNT_6ParamsE<<<{16, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                   6778736.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                    786432.000
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEENS7_20permutation_iteratorIPfNS7_18transform_iteratorIZ17attention_forwardSF_SF_SF_SF_SF_SF_iiiiEUliE0_NS7_17counting_iteratorIiNS7_11use_defaultESJ_SJ_EESJ_SJ_EEEENS9_14no_stencil_tagENS8_8identityENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                         0.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                         0.000
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 1, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                   3637904.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                    294912.000
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
-----------------------------------------------------------------------------------
Range Name: residual1
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                         0.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                         0.000
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
-----------------------------------------------------------------------------------
Range Name: ln2
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                         0.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                         0.000
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
-----------------------------------------------------------------------------------
Range Name: ff
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                  14550880.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                   1179648.000
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fIPKfPfNS9_14no_stencil_tagEZ12gelu_forwardSD_SC_iEUlfE_NS9_21always_true_predicateEEEEEvT0_T1_<<<{24576, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                         0.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                         0.000
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x256_32x3_tn_align4EEvNT_6ParamsE<<<{128, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                  10692320.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                    884736.000
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
-----------------------------------------------------------------------------------
Range Name: residual2
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                         0.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                         0.000
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
-----------------------------------------------------------------------------------
Range Name: vecadd
======================================================================================
Kernel: _Z6vecAddPKfS0_Pfi<<<{12288, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                         0.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                         0.000
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
-----------------------------------------------------------------------------------
Range Name: vecadd_thrust
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                         0.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_bypass.sum                         0.000
sm__sass_l1tex_t_sectors_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
sm__sass_l1tex_t_requests_pipe_lsu_mem_global_op_ldgsts_cache_access.sum                         0.000
-----------------------------------------------------------------------------------
==> ./train_gpt2cu 2 lts__t_requests_srcunit_tex_op_read.sum lts__t_requests_srcunit_tex_op_write.sum dram__sectors_read.sum dram__sectors_write.sum
Adding metric: lts__t_requests_srcunit_tex_op_read.sum
Adding metric: lts__t_requests_srcunit_tex_op_write.sum
Adding metric: dram__sectors_read.sum
Adding metric: dram__sectors_write.sum
Setting output path: ./output/result.csv
input dataset prefix: data/tiny_shakespeare
output log file: NULL
batch size B: 4
sequence length T: 1024
learning rate: 0.000100
val_loss_every: 20
val_max_batches: 20
sample_every: 20
genT: 64
[System]
Device 0: NVIDIA A100-SXM4-40GB
enable_tf32: 1
[GPT-2]
max_seq_len: 1024
vocab_size: 50257
num_layers: 12
num_heads: 12
channels: 768
num_parameters: 124439808
allocated 474 MiB for model parameters
train dataset num_batches: 74
val dataset num_batches: 8
Initializing CUDA driver...
Compute Capability of Device: 8.0
Num of Passes: 1
Forward pass 0
num_activations: 1868386304
allocated 7127 MiB for activations
allocated 474 MiB for parameter gradients
allocated 1421 MiB for activation gradients
allocated 474 MiB for AdamW optimizer state m
allocated 474 MiB for AdamW optimizer state v
step 1/2: train loss 9.130970 (145.490859 ms)
Forward pass 1
step 2/2: train loss 8.668049 (457.427103 ms)
total average iteration time: 301.458981 ms
Number of ranges: 17
m_profilerRanges size: 17
Range Name: encoder_forward
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tEiZ15encoder_forwardPfRKN6thrust20THRUST_200700_800_NS13device_vectorIiNS8_16device_allocatorIiEEEES6_S6_iiiiEUliE_EEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__sectors_write.sum                                               405760.000
dram__sectors_read.sum                                                201136.000
lts__t_requests_srcunit_tex_op_write.sum                               98304.000
lts__t_requests_srcunit_tex_op_read.sum                               186819.000
-----------------------------------------------------------------------------------
Range Name: ln1
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__sectors_write.sum                                               299588.000
dram__sectors_read.sum                                                   236.000
lts__t_requests_srcunit_tex_op_write.sum                              104528.000
lts__t_requests_srcunit_tex_op_read.sum                               104821.000
-----------------------------------------------------------------------------------
Range Name: attention
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__sectors_write.sum                                              1378096.000
dram__sectors_read.sum                                               1013724.000
lts__t_requests_srcunit_tex_op_write.sum                              294912.000
lts__t_requests_srcunit_tex_op_read.sum                              7082034.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElNS2_12op_wrapper_tIlZ17attention_forwardPfS7_S7_S7_S7_S7_iiiiEUliE_N6thrust20THRUST_200700_800_NS17counting_iteratorIiNSA_11use_defaultESC_SC_EEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__sectors_write.sum                                               957624.000
dram__sectors_read.sum                                               1106872.000
lts__t_requests_srcunit_tex_op_write.sum                              294912.000
lts__t_requests_srcunit_tex_op_read.sum                               294912.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I51cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4EEvNT_6ParamsE<<<{64, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__sectors_write.sum                                              6246996.000
dram__sectors_read.sum                                                787336.000
lts__t_requests_srcunit_tex_op_write.sum                             1572864.000
lts__t_requests_srcunit_tex_op_read.sum                              3932160.000
-----------------------------------------------------------------------------------
Kernel: _Z23softmax_forward_kernel5PffPKfii<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__sectors_write.sum                                              3196160.000
dram__sectors_read.sum                                               2969024.000
lts__t_requests_srcunit_tex_op_write.sum                              811008.000
lts__t_requests_srcunit_tex_op_read.sum                               946864.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I50cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4EEvNT_6ParamsE<<<{16, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__sectors_write.sum                                               831488.000
dram__sectors_read.sum                                               6462212.000
lts__t_requests_srcunit_tex_op_write.sum                               98304.000
lts__t_requests_srcunit_tex_op_read.sum                              4718592.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEENS7_20permutation_iteratorIPfNS7_18transform_iteratorIZ17attention_forwardSF_SF_SF_SF_SF_SF_iiiiEUliE0_NS7_17counting_iteratorIiNS7_11use_defaultESJ_SJ_EESJ_SJ_EEEENS9_14no_stencil_tagENS8_8identityENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__sectors_write.sum                                                36552.000
dram__sectors_read.sum                                                306004.000
lts__t_requests_srcunit_tex_op_write.sum                               98304.000
lts__t_requests_srcunit_tex_op_read.sum                                98304.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 1, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__sectors_write.sum                                               232564.000
dram__sectors_read.sum                                                 75484.000
lts__t_requests_srcunit_tex_op_write.sum                               98304.000
lts__t_requests_srcunit_tex_op_read.sum                              2360615.000
-----------------------------------------------------------------------------------
Range Name: residual1
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__sectors_write.sum                                               387148.000
dram__sectors_read.sum                                                402284.000
lts__t_requests_srcunit_tex_op_write.sum                               98304.000
lts__t_requests_srcunit_tex_op_read.sum                               196608.000
-----------------------------------------------------------------------------------
Range Name: ln2
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__sectors_write.sum                                               355376.000
dram__sectors_read.sum                                                   372.000
lts__t_requests_srcunit_tex_op_write.sum                              104621.000
lts__t_requests_srcunit_tex_op_read.sum                               104711.000
-----------------------------------------------------------------------------------
Range Name: ff
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__sectors_write.sum                                              1702184.000
dram__sectors_read.sum                                               1380712.000
lts__t_requests_srcunit_tex_op_write.sum                              393216.000
lts__t_requests_srcunit_tex_op_read.sum                              9442985.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fIPKfPfNS9_14no_stencil_tagEZ12gelu_forwardSD_SC_iEUlfE_NS9_21always_true_predicateEEEEEvT0_T1_<<<{24576, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__sectors_write.sum                                              1567528.000
dram__sectors_read.sum                                               1552028.000
lts__t_requests_srcunit_tex_op_write.sum                              393216.000
lts__t_requests_srcunit_tex_op_read.sum                               393216.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x256_32x3_tn_align4EEvNT_6ParamsE<<<{128, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__sectors_write.sum                                               441192.000
dram__sectors_read.sum                                               1773028.000
lts__t_requests_srcunit_tex_op_write.sum                               98304.000
lts__t_requests_srcunit_tex_op_read.sum                              3539867.000
-----------------------------------------------------------------------------------
Range Name: residual2
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__sectors_write.sum                                               177164.000
dram__sectors_read.sum                                                393280.000
lts__t_requests_srcunit_tex_op_write.sum                               98304.000
lts__t_requests_srcunit_tex_op_read.sum                               196608.000
-----------------------------------------------------------------------------------
Range Name: vecadd
======================================================================================
Kernel: _Z6vecAddPKfS0_Pfi<<<{12288, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__sectors_write.sum                                               445360.000
dram__sectors_read.sum                                                441048.000
lts__t_requests_srcunit_tex_op_write.sum                               98304.000
lts__t_requests_srcunit_tex_op_read.sum                               196608.000
-----------------------------------------------------------------------------------
Range Name: vecadd_thrust
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
dram__sectors_write.sum                                               254032.000
dram__sectors_read.sum                                                234184.000
lts__t_requests_srcunit_tex_op_write.sum                               98304.000
lts__t_requests_srcunit_tex_op_read.sum                               196608.000
-----------------------------------------------------------------------------------
==> ./train_gpt2cu 2 lts__t_requests_srcunit_l1_op_read.sum lts__t_requests_srcunit_l1_op_write.sum lts__t_sectors_op_read.sum lts__t_sectors_op_write.sum
Adding metric: lts__t_requests_srcunit_l1_op_read.sum
Adding metric: lts__t_requests_srcunit_l1_op_write.sum
Adding metric: lts__t_sectors_op_read.sum
Adding metric: lts__t_sectors_op_write.sum
Setting output path: ./output/result.csv
input dataset prefix: data/tiny_shakespeare
output log file: NULL
batch size B: 4
sequence length T: 1024
learning rate: 0.000100
val_loss_every: 20
val_max_batches: 20
sample_every: 20
genT: 64
[System]
Device 0: NVIDIA A100-SXM4-40GB
enable_tf32: 1
[GPT-2]
max_seq_len: 1024
vocab_size: 50257
num_layers: 12
num_heads: 12
channels: 768
num_parameters: 124439808
allocated 474 MiB for model parameters
train dataset num_batches: 74
val dataset num_batches: 8
Initializing CUDA driver...
Compute Capability of Device: 8.0
Num of Passes: 1
Forward pass 0
num_activations: 1868386304
allocated 7127 MiB for activations
allocated 474 MiB for parameter gradients
allocated 1421 MiB for activation gradients
allocated 474 MiB for AdamW optimizer state m
allocated 474 MiB for AdamW optimizer state v
step 1/2: train loss 9.130970 (144.969075 ms)
Forward pass 1
step 2/2: train loss 8.668050 (357.783773 ms)
total average iteration time: 251.376424 ms
Number of ranges: 17
m_profilerRanges size: 17
Range Name: encoder_forward
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tEiZ15encoder_forwardPfRKN6thrust20THRUST_200700_800_NS13device_vectorIiNS8_16device_allocatorIiEEEES6_S6_iiiiEUliE_EEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
lts__t_sectors_op_read.sum                                            893231.000
lts__t_requests_srcunit_l1_op_write.sum                                    0.000
lts__t_sectors_op_write.sum                                           594653.000
lts__t_requests_srcunit_l1_op_read.sum                                     0.000
-----------------------------------------------------------------------------------
Range Name: ln1
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
lts__t_sectors_op_read.sum                                            516757.000
lts__t_requests_srcunit_l1_op_write.sum                                    0.000
lts__t_sectors_op_write.sum                                           600474.000
lts__t_requests_srcunit_l1_op_read.sum                                     0.000
-----------------------------------------------------------------------------------
Range Name: attention
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
lts__t_sectors_op_read.sum                                          15305311.000
lts__t_requests_srcunit_l1_op_write.sum                                    0.000
lts__t_sectors_op_write.sum                                          1770013.000
lts__t_requests_srcunit_l1_op_read.sum                                     0.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElNS2_12op_wrapper_tIlZ17attention_forwardPfS7_S7_S7_S7_S7_iiiiEUliE_N6thrust20THRUST_200700_800_NS17counting_iteratorIiNSA_11use_defaultESC_SC_EEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
lts__t_sectors_op_read.sum                                           1754955.000
lts__t_requests_srcunit_l1_op_write.sum                                    0.000
lts__t_sectors_op_write.sum                                          1768848.000
lts__t_requests_srcunit_l1_op_read.sum                                     0.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I51cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4EEvNT_6ParamsE<<<{64, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
lts__t_sectors_op_read.sum                                           8597753.000
lts__t_requests_srcunit_l1_op_write.sum                                    0.000
lts__t_sectors_op_write.sum                                          9437692.000
lts__t_requests_srcunit_l1_op_read.sum                                     0.000
-----------------------------------------------------------------------------------
Kernel: _Z23softmax_forward_kernel5PffPKfii<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
lts__t_sectors_op_read.sum                                           4928618.000
lts__t_requests_srcunit_l1_op_write.sum                                    0.000
lts__t_sectors_op_write.sum                                          4790556.000
lts__t_requests_srcunit_l1_op_read.sum                                     0.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I50cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4EEvNT_6ParamsE<<<{16, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
lts__t_sectors_op_read.sum                                          16137548.000
lts__t_requests_srcunit_l1_op_write.sum                                    0.000
lts__t_sectors_op_write.sum                                           598549.000
lts__t_requests_srcunit_l1_op_read.sum                                     0.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEENS7_20permutation_iteratorIPfNS7_18transform_iteratorIZ17attention_forwardSF_SF_SF_SF_SF_SF_iiiiEUliE0_NS7_17counting_iteratorIiNS7_11use_defaultESJ_SJ_EESJ_SJ_EEEENS9_14no_stencil_tagENS8_8identityENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
lts__t_sectors_op_read.sum                                            574109.000
lts__t_requests_srcunit_l1_op_write.sum                                    0.000
lts__t_sectors_op_write.sum                                           588684.000
lts__t_requests_srcunit_l1_op_read.sum                                     0.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 1, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
lts__t_sectors_op_read.sum                                           4977803.000
lts__t_requests_srcunit_l1_op_write.sum                                    0.000
lts__t_sectors_op_write.sum                                           590447.000
lts__t_requests_srcunit_l1_op_read.sum                                     0.000
-----------------------------------------------------------------------------------
Range Name: residual1
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
lts__t_sectors_op_read.sum                                           1080653.000
lts__t_requests_srcunit_l1_op_write.sum                                    0.000
lts__t_sectors_op_write.sum                                           587432.000
lts__t_requests_srcunit_l1_op_read.sum                                     0.000
-----------------------------------------------------------------------------------
Range Name: ln2
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
lts__t_sectors_op_read.sum                                            515023.000
lts__t_requests_srcunit_l1_op_write.sum                                    0.000
lts__t_sectors_op_write.sum                                           600643.000
lts__t_requests_srcunit_l1_op_read.sum                                     0.000
-----------------------------------------------------------------------------------
Range Name: ff
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
lts__t_sectors_op_read.sum                                          20327159.000
lts__t_requests_srcunit_l1_op_write.sum                                    0.000
lts__t_sectors_op_write.sum                                          2358905.000
lts__t_requests_srcunit_l1_op_read.sum                                     0.000
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fIPKfPfNS9_14no_stencil_tagEZ12gelu_forwardSD_SC_iEUlfE_NS9_21always_true_predicateEEEEEvT0_T1_<<<{24576, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
lts__t_sectors_op_read.sum                                           2362193.000
lts__t_requests_srcunit_l1_op_write.sum                                    0.000
lts__t_sectors_op_write.sum                                          2356591.000
lts__t_requests_srcunit_l1_op_read.sum                                     0.000
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x256_32x3_tn_align4EEvNT_6ParamsE<<<{128, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
lts__t_sectors_op_read.sum                                          15906534.000
lts__t_requests_srcunit_l1_op_write.sum                                    0.000
lts__t_sectors_op_write.sum                                           589831.000
lts__t_requests_srcunit_l1_op_read.sum                                     0.000
-----------------------------------------------------------------------------------
Range Name: residual2
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
lts__t_sectors_op_read.sum                                           1083311.000
lts__t_requests_srcunit_l1_op_write.sum                                    0.000
lts__t_sectors_op_write.sum                                           587358.000
lts__t_requests_srcunit_l1_op_read.sum                                     0.000
-----------------------------------------------------------------------------------
Range Name: vecadd
======================================================================================
Kernel: _Z6vecAddPKfS0_Pfi<<<{12288, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
lts__t_sectors_op_read.sum                                           1116895.000
lts__t_requests_srcunit_l1_op_write.sum                                    0.000
lts__t_sectors_op_write.sum                                           590097.000
lts__t_requests_srcunit_l1_op_read.sum                                     0.000
-----------------------------------------------------------------------------------
Range Name: vecadd_thrust
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
lts__t_sectors_op_read.sum                                           1066924.000
lts__t_requests_srcunit_l1_op_write.sum                                    0.000
lts__t_sectors_op_write.sum                                           591926.000
lts__t_requests_srcunit_l1_op_read.sum                                     0.000
-----------------------------------------------------------------------------------
==> ./train_gpt2cu 2 smsp__average_warp_latency_per_inst_issued.ratio --max
Adding metric: smsp__average_warp_latency_per_inst_issued.ratio
Setting output option to MAX
Setting output path: ./output/result.csv
input dataset prefix: data/tiny_shakespeare
output log file: NULL
batch size B: 4
sequence length T: 1024
learning rate: 0.000100
val_loss_every: 20
val_max_batches: 20
sample_every: 20
genT: 64
[System]
Device 0: NVIDIA A100-SXM4-40GB
enable_tf32: 1
[GPT-2]
max_seq_len: 1024
vocab_size: 50257
num_layers: 12
num_heads: 12
channels: 768
num_parameters: 124439808
allocated 474 MiB for model parameters
train dataset num_batches: 74
val dataset num_batches: 8
Initializing CUDA driver...
Compute Capability of Device: 8.0
Num of Passes: 1
Forward pass 0
num_activations: 1868386304
allocated 7127 MiB for activations
allocated 474 MiB for parameter gradients
allocated 1421 MiB for activation gradients
allocated 474 MiB for AdamW optimizer state m
allocated 474 MiB for AdamW optimizer state v
step 1/2: train loss 9.130970 (145.690955 ms)
Forward pass 1
step 2/2: train loss 8.668048 (475.396523 ms)
total average iteration time: 310.543739 ms
Number of ranges: 17
m_profilerRanges size: 17
Range Name: encoder_forward
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tEiZ15encoder_forwardPfRKN6thrust20THRUST_200700_800_NS13device_vectorIiNS8_16device_allocatorIiEEEES6_S6_iiiiEUliE_EEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warp_latency_per_inst_issued.ratio                          27.609
-----------------------------------------------------------------------------------
Range Name: ln1
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warp_latency_per_inst_issued.ratio                          26.257
-----------------------------------------------------------------------------------
Range Name: attention
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warp_latency_per_inst_issued.ratio                           4.222
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElNS2_12op_wrapper_tIlZ17attention_forwardPfS7_S7_S7_S7_S7_iiiiEUliE_N6thrust20THRUST_200700_800_NS17counting_iteratorIiNSA_11use_defaultESC_SC_EEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warp_latency_per_inst_issued.ratio                          58.750
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I51cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4EEvNT_6ParamsE<<<{64, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warp_latency_per_inst_issued.ratio                           7.719
-----------------------------------------------------------------------------------
Kernel: _Z23softmax_forward_kernel5PffPKfii<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warp_latency_per_inst_issued.ratio                          38.636
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I50cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4EEvNT_6ParamsE<<<{16, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warp_latency_per_inst_issued.ratio                           9.842
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEENS7_20permutation_iteratorIPfNS7_18transform_iteratorIZ17attention_forwardSF_SF_SF_SF_SF_SF_iiiiEUliE0_NS7_17counting_iteratorIiNS7_11use_defaultESJ_SJ_EESJ_SJ_EEEENS9_14no_stencil_tagENS8_8identityENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warp_latency_per_inst_issued.ratio                          17.782
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 1, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warp_latency_per_inst_issued.ratio                           4.033
-----------------------------------------------------------------------------------
Range Name: residual1
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warp_latency_per_inst_issued.ratio                          91.903
-----------------------------------------------------------------------------------
Range Name: ln2
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warp_latency_per_inst_issued.ratio                          28.571
-----------------------------------------------------------------------------------
Range Name: ff
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warp_latency_per_inst_issued.ratio                           4.234
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fIPKfPfNS9_14no_stencil_tagEZ12gelu_forwardSD_SC_iEUlfE_NS9_21always_true_predicateEEEEEvT0_T1_<<<{24576, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warp_latency_per_inst_issued.ratio                          86.174
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x256_32x3_tn_align4EEvNT_6ParamsE<<<{128, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warp_latency_per_inst_issued.ratio                           4.522
-----------------------------------------------------------------------------------
Range Name: residual2
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warp_latency_per_inst_issued.ratio                          69.279
-----------------------------------------------------------------------------------
Range Name: vecadd
======================================================================================
Kernel: _Z6vecAddPKfS0_Pfi<<<{12288, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warp_latency_per_inst_issued.ratio                         113.029
-----------------------------------------------------------------------------------
Range Name: vecadd_thrust
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warp_latency_per_inst_issued.ratio                          71.250
-----------------------------------------------------------------------------------
==> ./train_gpt2cu 2 smsp__average_warps_issue_stalled_math_pipe_throttle_per_issue_active.ratio smsp__average_warps_issue_stalled_wait_per_issue_active.ratio --max
Adding metric: smsp__average_warps_issue_stalled_math_pipe_throttle_per_issue_active.ratio
Adding metric: smsp__average_warps_issue_stalled_wait_per_issue_active.ratio
Setting output option to MAX
Setting output path: ./output/result.csv
input dataset prefix: data/tiny_shakespeare
output log file: NULL
batch size B: 4
sequence length T: 1024
learning rate: 0.000100
val_loss_every: 20
val_max_batches: 20
sample_every: 20
genT: 64
[System]
Device 0: NVIDIA A100-SXM4-40GB
enable_tf32: 1
[GPT-2]
max_seq_len: 1024
vocab_size: 50257
num_layers: 12
num_heads: 12
channels: 768
num_parameters: 124439808
allocated 474 MiB for model parameters
train dataset num_batches: 74
val dataset num_batches: 8
Initializing CUDA driver...
Compute Capability of Device: 8.0
Num of Passes: 1
Forward pass 0
num_activations: 1868386304
allocated 7127 MiB for activations
allocated 474 MiB for parameter gradients
allocated 1421 MiB for activation gradients
allocated 474 MiB for AdamW optimizer state m
allocated 474 MiB for AdamW optimizer state v
step 1/2: train loss 9.130970 (146.121650 ms)
Forward pass 1
step 2/2: train loss 8.668050 (478.435588 ms)
total average iteration time: 312.278619 ms
Number of ranges: 17
m_profilerRanges size: 17
Range Name: encoder_forward
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tEiZ15encoder_forwardPfRKN6thrust20THRUST_200700_800_NS13device_vectorIiNS8_16device_allocatorIiEEEES6_S6_iiiiEUliE_EEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_wait_per_issue_active.ratio                         3.457
smsp__average_warps_issue_stalled_math_pipe_throttle_per_issue_active.ratio                         2.477
-----------------------------------------------------------------------------------
Range Name: ln1
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_wait_per_issue_active.ratio                         1.798
smsp__average_warps_issue_stalled_math_pipe_throttle_per_issue_active.ratio                         1.791
-----------------------------------------------------------------------------------
Range Name: attention
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_wait_per_issue_active.ratio                         0.997
smsp__average_warps_issue_stalled_math_pipe_throttle_per_issue_active.ratio                         1.061
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElNS2_12op_wrapper_tIlZ17attention_forwardPfS7_S7_S7_S7_S7_iiiiEUliE_N6thrust20THRUST_200700_800_NS17counting_iteratorIiNSA_11use_defaultESC_SC_EEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_wait_per_issue_active.ratio                         2.579
smsp__average_warps_issue_stalled_math_pipe_throttle_per_issue_active.ratio                         1.046
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I51cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4EEvNT_6ParamsE<<<{64, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_wait_per_issue_active.ratio                         0.977
smsp__average_warps_issue_stalled_math_pipe_throttle_per_issue_active.ratio                         0.243
-----------------------------------------------------------------------------------
Kernel: _Z23softmax_forward_kernel5PffPKfii<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_wait_per_issue_active.ratio                         1.954
smsp__average_warps_issue_stalled_math_pipe_throttle_per_issue_active.ratio                         0.868
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I50cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4EEvNT_6ParamsE<<<{16, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_wait_per_issue_active.ratio                         0.533
smsp__average_warps_issue_stalled_math_pipe_throttle_per_issue_active.ratio                         0.615
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEENS7_20permutation_iteratorIPfNS7_18transform_iteratorIZ17attention_forwardSF_SF_SF_SF_SF_SF_iiiiEUliE0_NS7_17counting_iteratorIiNS7_11use_defaultESJ_SJ_EESJ_SJ_EEEENS9_14no_stencil_tagENS8_8identityENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_wait_per_issue_active.ratio                         3.009
smsp__average_warps_issue_stalled_math_pipe_throttle_per_issue_active.ratio                         4.193
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 1, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_wait_per_issue_active.ratio                         0.980
smsp__average_warps_issue_stalled_math_pipe_throttle_per_issue_active.ratio                         1.065
-----------------------------------------------------------------------------------
Range Name: residual1
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_wait_per_issue_active.ratio                         1.745
smsp__average_warps_issue_stalled_math_pipe_throttle_per_issue_active.ratio                         1.451
-----------------------------------------------------------------------------------
Range Name: ln2
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_wait_per_issue_active.ratio                         1.798
smsp__average_warps_issue_stalled_math_pipe_throttle_per_issue_active.ratio                         1.778
-----------------------------------------------------------------------------------
Range Name: ff
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_wait_per_issue_active.ratio                         0.999
smsp__average_warps_issue_stalled_math_pipe_throttle_per_issue_active.ratio                         1.094
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fIPKfPfNS9_14no_stencil_tagEZ12gelu_forwardSD_SC_iEUlfE_NS9_21always_true_predicateEEEEEvT0_T1_<<<{24576, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_wait_per_issue_active.ratio                         1.970
smsp__average_warps_issue_stalled_math_pipe_throttle_per_issue_active.ratio                         1.230
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x256_32x3_tn_align4EEvNT_6ParamsE<<<{128, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_wait_per_issue_active.ratio                         1.144
smsp__average_warps_issue_stalled_math_pipe_throttle_per_issue_active.ratio                         1.785
-----------------------------------------------------------------------------------
Range Name: residual2
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_wait_per_issue_active.ratio                         1.747
smsp__average_warps_issue_stalled_math_pipe_throttle_per_issue_active.ratio                         1.415
-----------------------------------------------------------------------------------
Range Name: vecadd
======================================================================================
Kernel: _Z6vecAddPKfS0_Pfi<<<{12288, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_wait_per_issue_active.ratio                         4.070
smsp__average_warps_issue_stalled_math_pipe_throttle_per_issue_active.ratio                         0.347
-----------------------------------------------------------------------------------
Range Name: vecadd_thrust
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_wait_per_issue_active.ratio                         1.750
smsp__average_warps_issue_stalled_math_pipe_throttle_per_issue_active.ratio                         1.399
-----------------------------------------------------------------------------------
==> ./train_gpt2cu 2 smsp__average_warps_issue_stalled_long_scoreboard_per_issue_active.ratio smsp__average_warps_issue_stalled_short_scoreboard_per_issue_active.ratio --max
Adding metric: smsp__average_warps_issue_stalled_long_scoreboard_per_issue_active.ratio
Adding metric: smsp__average_warps_issue_stalled_short_scoreboard_per_issue_active.ratio
Setting output option to MAX
Setting output path: ./output/result.csv
input dataset prefix: data/tiny_shakespeare
output log file: NULL
batch size B: 4
sequence length T: 1024
learning rate: 0.000100
val_loss_every: 20
val_max_batches: 20
sample_every: 20
genT: 64
[System]
Device 0: NVIDIA A100-SXM4-40GB
enable_tf32: 1
[GPT-2]
max_seq_len: 1024
vocab_size: 50257
num_layers: 12
num_heads: 12
channels: 768
num_parameters: 124439808
allocated 474 MiB for model parameters
train dataset num_batches: 74
val dataset num_batches: 8
Initializing CUDA driver...
Compute Capability of Device: 8.0
Num of Passes: 1
Forward pass 0
num_activations: 1868386304
allocated 7127 MiB for activations
allocated 474 MiB for parameter gradients
allocated 1421 MiB for activation gradients
allocated 474 MiB for AdamW optimizer state m
allocated 474 MiB for AdamW optimizer state v
step 1/2: train loss 9.130970 (144.649459 ms)
Forward pass 1
step 2/2: train loss 8.668051 (481.566840 ms)
total average iteration time: 313.108149 ms
Number of ranges: 17
m_profilerRanges size: 17
Range Name: encoder_forward
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tEiZ15encoder_forwardPfRKN6thrust20THRUST_200700_800_NS13device_vectorIiNS8_16device_allocatorIiEEEES6_S6_iiiiEUliE_EEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_short_scoreboard_per_issue_active.ratio                         0.546
smsp__average_warps_issue_stalled_long_scoreboard_per_issue_active.ratio                        14.698
-----------------------------------------------------------------------------------
Range Name: ln1
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_short_scoreboard_per_issue_active.ratio                         0.284
smsp__average_warps_issue_stalled_long_scoreboard_per_issue_active.ratio                        17.830
-----------------------------------------------------------------------------------
Range Name: attention
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_short_scoreboard_per_issue_active.ratio                         0.158
smsp__average_warps_issue_stalled_long_scoreboard_per_issue_active.ratio                         0.144
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElNS2_12op_wrapper_tIlZ17attention_forwardPfS7_S7_S7_S7_S7_iiiiEUliE_N6thrust20THRUST_200700_800_NS17counting_iteratorIiNSA_11use_defaultESC_SC_EEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_short_scoreboard_per_issue_active.ratio                         0.313
smsp__average_warps_issue_stalled_long_scoreboard_per_issue_active.ratio                        50.771
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I51cutlass_80_tensorop_s1688gemm_256x64_16x4_tn_align4EEvNT_6ParamsE<<<{64, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_short_scoreboard_per_issue_active.ratio                         0.800
smsp__average_warps_issue_stalled_long_scoreboard_per_issue_active.ratio                         0.970
-----------------------------------------------------------------------------------
Kernel: _Z23softmax_forward_kernel5PffPKfii<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_short_scoreboard_per_issue_active.ratio                         1.181
smsp__average_warps_issue_stalled_long_scoreboard_per_issue_active.ratio                        31.967
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I50cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4EEvNT_6ParamsE<<<{16, 1, 48}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_short_scoreboard_per_issue_active.ratio                         0.564
smsp__average_warps_issue_stalled_long_scoreboard_per_issue_active.ratio                         0.994
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEENS7_20permutation_iteratorIPfNS7_18transform_iteratorIZ17attention_forwardSF_SF_SF_SF_SF_SF_iiiiEUliE0_NS7_17counting_iteratorIiNS7_11use_defaultESJ_SJ_EESJ_SJ_EEEENS9_14no_stencil_tagENS8_8identityENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_short_scoreboard_per_issue_active.ratio                         0.228
smsp__average_warps_issue_stalled_long_scoreboard_per_issue_active.ratio                         1.727
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 1, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_short_scoreboard_per_issue_active.ratio                         0.117
smsp__average_warps_issue_stalled_long_scoreboard_per_issue_active.ratio                         0.098
-----------------------------------------------------------------------------------
Range Name: residual1
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_short_scoreboard_per_issue_active.ratio                         0.421
smsp__average_warps_issue_stalled_long_scoreboard_per_issue_active.ratio                        81.685
-----------------------------------------------------------------------------------
Range Name: ln2
======================================================================================
Kernel: _Z25layernorm_forward_kernel3PfS_S_PKfS1_S1_ii<<<{256, 1, 1}, {512, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_short_scoreboard_per_issue_active.ratio                         0.283
smsp__average_warps_issue_stalled_long_scoreboard_per_issue_active.ratio                        19.502
-----------------------------------------------------------------------------------
Range Name: ff
======================================================================================
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x128_16x5_tn_align4EEvNT_6ParamsE<<<{256, 3, 1}, {128, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_short_scoreboard_per_issue_active.ratio                         0.163
smsp__average_warps_issue_stalled_long_scoreboard_per_issue_active.ratio                         0.140
-----------------------------------------------------------------------------------
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform17unary_transform_fIPKfPfNS9_14no_stencil_tagEZ12gelu_forwardSD_SC_iEUlfE_NS9_21always_true_predicateEEEEEvT0_T1_<<<{24576, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_short_scoreboard_per_issue_active.ratio                         1.385
smsp__average_warps_issue_stalled_long_scoreboard_per_issue_active.ratio                        77.361
-----------------------------------------------------------------------------------
Kernel: _ZN7cutlass7Kernel2I52cutlass_80_tensorop_s1688gemm_128x256_32x3_tn_align4EEvNT_6ParamsE<<<{128, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_short_scoreboard_per_issue_active.ratio                         0.046
smsp__average_warps_issue_stalled_long_scoreboard_per_issue_active.ratio                         0.061
-----------------------------------------------------------------------------------
Range Name: residual2
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_short_scoreboard_per_issue_active.ratio                         0.429
smsp__average_warps_issue_stalled_long_scoreboard_per_issue_active.ratio                        59.642
-----------------------------------------------------------------------------------
Range Name: vecadd
======================================================================================
Kernel: _Z6vecAddPKfS0_Pfi<<<{12288, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_short_scoreboard_per_issue_active.ratio                         1.622
smsp__average_warps_issue_stalled_long_scoreboard_per_issue_active.ratio                       100.517
-----------------------------------------------------------------------------------
Range Name: vecadd_thrust
======================================================================================
Kernel: _ZN3cub17CUB_200700_800_NS6detail8for_each13static_kernelINS2_12policy_hub_t12policy_350_tElN6thrust20THRUST_200700_800_NS8cuda_cub11__transform18binary_transform_fINS0_26CacheModifiedInputIteratorILNS0_17CacheLoadModifierE3EflEESD_PfNS9_14no_stencil_tagENS7_4plusIfEENS9_21always_true_predicateEEEEEvT0_T1_<<<{6144, 1, 1}, {256, 1, 1} >>>
-----------------------------------------------------------------------------------
smsp__average_warps_issue_stalled_short_scoreboard_per_issue_active.ratio                         0.443
smsp__average_warps_issue_stalled_long_scoreboard_per_issue_active.ratio                        60.871
-----------------------------------------------------------------------------------
All metric batches completed.
